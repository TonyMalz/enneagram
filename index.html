<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://fonts.googleapis.com/css?family=Libre+Baskerville" rel="stylesheet">
	<title>Enneagram Test</title>
	<style type="text/css">
	
	html, body{
		margin: 0;
		padding: 0;
		height: 100%;
		font-size: 1.3rem;
	}

	main {
		display: grid;
		grid-auto-rows: minmax(100px,auto);
	}

	header {
		transform: translate3d(0,0,0);
	    text-align: center;
	    font-size: 1.4rem;
	    color: white;
		overflow: hidden;
	    background-color: #023756;
	    position: fixed; /* Set the navbar to fixed position */
	    top: 0; /* Position the navbar at the top of the page */
	    width: 100%; /* Full width */
	    z-index: 1;
	}

	main > div:nth-child(even){
		background-color: #c2468f0d;
	}

	.question {
		padding: 30px;
	}

	button {
		width: 50px;
		height: 40px;
		!border-radius: 10px;
		background-color: #88A040;
		cursor: pointer;
	}

	.buttonstart{
		border-top-left-radius:18px;
		border-bottom-left-radius:18px;
		width: 55px;
	}

	.buttonend{
		border-top-right-radius:18px;
		border-bottom-right-radius:18px;
		width: 55px;
	}

	span {
		color: #00000050;
	}
	input {
		cursor: pointer;
	}

	@media screen and (max-width: 39.9375em) {
		main {
			display: grid;
			grid-auto-rows: minmax(100px,auto);
			font-size: 0.7rem;
		}
		header {
			transform: translate3d(0,0,0);
		    text-align: center;
		    font-size: 0.7rem;
		    color: white;
			overflow: hidden;
		    background-color: #023756;
		    position: fixed;
		    top: 0;
		    width: 100%;
		    z-index: 1;
		}
		.question {
			padding: 10px;
		}
	}

	.rowgrid {
		display: grid;
		grid-template-columns: repeat(2,1fr);
		grid-template-rows: repeat(3, 1fr);
		grid-template-areas: 
	    "a b"
	    "c1 c2"
	    "d1 d2";
	}
	.rowgrid div{
		padding-bottom: 5px;
	}

	.a {
		grid-area: a;
		height: 85%;
		text-align: center;
		border-right: 1px dotted #dad9d9;
	}

	.b {
		grid-area: b;
		height: 85%;
		text-align: center;
	}

	.a, .b {
		padding-top: 15px;
		padding-right: 5px;
		padding-left: 5px;
	}

	.c1 {
		grid-area: c1;
		display: grid;
		grid-template-columns:repeat(3,min-content);
		justify-self: end;
	}

	.c2 {
		grid-area: c2;
		display: grid;
		grid-template-columns:repeat(3,min-content);
		justify-self: start;
	}

	.d1 {
		grid-area: d1;
		display: grid;
		grid-template-columns:repeat(3,1fr);
		justify-self: end;
		!border-right: 1px dotted #969696;
	}

	.d2 {
		grid-area: d2;
		display: grid;
		grid-template-columns:repeat(3,1fr);
		justify-self: start;
		!border-left: 1px dotted #969696;
	}
	.d1, .d2 {
		font-size: 0.5rem;
	}
	.d1 span, .d2 span {
		text-align: center;
		width: 50px;
	}

	#next {
		display: none;
		width: 100%;
		height: 100%;
		align-self: stretch;
		justify-content: center;
		color: white;
		font-size: 1rem;
	}


	</style>
<body>
<header>
	<div class="question">Welche Verhaltensmerkmale treffen nach Ihrem Urteil für Ihre Persönlichkeit zu?</div>
</header>
<main>
	<button id='next'>weiter</button>
</main>

<script id='rowTemplate' type="template">
	<div class="rowgrid">
		<div class="a">{left}</div>
		<div class="b">{right}</div>
		<div class="c1">
			<button class="buttonstart" onclick="tick(this.children[0],this)"><input type="radio" name="{radioName}" value="-3"></button>
			<button onclick="tick(this.children[0],this)"><input type="radio" name="{radioName}" value="-2"></button>
			<button onclick="tick(this.children[0],this)"><input type="radio" name="{radioName}" value="-1"></button>
		</div>
		<div class="c2">
			<button onclick="tick(this.children[0],this)"><input type="radio" name="{radioName}" value="1"></button>
			<button onclick="tick(this.children[0],this)"><input type="radio" name="{radioName}" value="2"></button>
			<button class="buttonend" onclick="tick(this.children[0],this)"><input type="radio" name="{radioName}" value="3"></button>
		</div>
		<div class="d1"><span>sehr</span><span>ziemlich</span><span>eher</span></div>
		<div class="d2"><span>eher</span><span>ziemlich</span><span>sehr</span></div>
	</div>
</script>
	
<script>
	var items = [
		[{text:'offensiv', type:'m'}, {text:'zurückhaltend',type:'i'}],
		[{text:'engagiert', type:'ms'},{text:'abwartend',type:'i'}],
		[{text:'unfreundlich/distanziert', type:'i'},{text:'freundlich',type:'s'}],
		[{text:'mitteilsam/redselig', type:'s'}, {text:'verschlossen',type:'i'}],
		[{text:'offen (intellektuell, emotional)', type:'msi'},{text:'skeptisch',type:'i'}],
		[{text:'ruhig/besonnen', type:'i'},{text:'quirlig/spontan',type:'s'}],
		[{text:'assoziativ', type:'s'}, {text:'systematisch',type:'i'}],
		[{text:'wortkarg', type:'i'},{text:'redegewandt',type:'ms'}],
		[{text:'konzentriert', type:'i'},{text:'leicht ablenkbar',type:'s'}],
		[{text:'ängstlich', type:'s'}, {text:'aggressiv',type:'m'}],
		[{text:'nutzenorientiert (pragmatisch)', type:'m'},{text:'problemorientiert',type:'i'}],
		[{text:'umfassend informiert', type:'si'},{text:'tendenziell informiert',type:'m'}],
		[{text:'sympathisch wirkend', type:'s'}, {text:'unsympathisch wirkend',type:'m'}],
		[{text:'arrogant', type:'m'},{text:'bescheiden',type:'i'}],
		[{text:'fordernd', type:'m'},{text:'zurückhaltend',type:'i'}],
		[{text:'spontan', type:'ms'}, {text:'abwägend',type:'i'}],
		[{text:'abwägend urteilend', type:'i'},{text:'spontan urteilend',type:'ms'}],
		[{text:'pragmatisch orientiert', type:'ms'},{text:'prinzipiell orientiert',type:'i'}],
		[{text:'durchsetzend', type:'mi'}, {text:'vermittelnd',type:'si'}],
		[{text:'rendend', type:'s'},{text:'zuhörend',type:'si'}],
		[{text:'belehrend', type:'m'},{text:'beratend',type:'i'}],
		[{text:'interessiert', type:'msi'}, {text:'gleichgültig',type:'mi'}],
		[{text:'flexibel', type:'s'},{text:'beharrend/starr',type:'m'}],
		[{text:'zielstrebig', type:'mi'},{text:'abschweifend',type:'s'}],
		[{text:'personenorientiert', type:'ms'}, {text:'sachorientiert',type:'i'}],
		[{text:'integrierend', type:'s'},{text:'polarisierend',type:'m'}],
		[{text:'beherrschend', type:'m'},{text:'sich einfügend',type:'s'}],
		[{text:'optimistisch', type:'ms'}, {text:'pessimistisch',type:'i'}],
		[{text:'nachsichtig', type:'s'},{text:'fordernd',type:'m'}],
		[{text:'zögernd', type:'i'},{text:'entschlossen',type:'m'}],
		];


	// set top margin of the main grid based on the actual header size
	var header = document.querySelector('header');
	var main = document.querySelector('main');
	var headerHeight = header.offsetHeight;
	main.style.marginTop = headerHeight;
	window.addEventListener('resize', function(){
		var newHeight = header.offsetHeight;
		if (newHeight == headerHeight) return;
		headerHeight = newHeight;
		main.style.marginTop = headerHeight;
	});

	// render questions
	var template = document.getElementById('rowTemplate').text.trim();
	var rows = '';
	for (var i = 0; i < items.length; i++) {
		var itemrow = items[i];
		var left = itemrow[0].text;
		var right = itemrow[1].text;
		rows += template.replace(/{left}/,left).replace(/{right}/,right).replace(/{radioName}/g,i);
	}
	main.innerHTML = rows + main.innerHTML;

	var glValues = {m:0,s:0,i:0};
	var glAnswers= {tab1:[], tab2:[], tab3:[], tab4:[]};
	var numAnswered=0;

	function tick(radio,parent){
		radio.checked = true;
		parent.parentNode.parentNode.querySelectorAll('button').forEach(function(elem){elem.style.backgroundColor='#88A040'})
		parent.style.backgroundColor='#6091A2';

		var itemID = radio.name;
		var answerItem = items[itemID][(radio.value<0)?0:1];
		glAnswers.tab1[itemID] = [answerItem,radio.value];
		numAnswered++;
		calcResults();
		checkIsDone();
	}
	
	function calcResults() {
		glValues = {m:0,s:0,i:0};
		for (var i = glAnswers.tab1.length - 1; i >= 0; i--) {
			if (glAnswers.tab1[i] === undefined){
				continue;
			}
			var item = glAnswers.tab1[i];
			var typeString = item[0].type;
			var value = item[1];
			for (var j = typeString.length - 1; j >= 0; j--) {
				if (typeString[j] == 'i')
					glValues.i += Math.abs(value);
				if (typeString[j] == 'm')
					glValues.m += Math.abs(value);
				if (typeString[j] == 's')
					glValues.s += Math.abs(value);
			}
		};
		//console.log(glValues);
	}
	
	function checkIsDone () {
		if (numAnswered == items.length){
			var next = document.getElementById('next');
			next.style.display="block";
			next.scrollIntoView();
		}
	}

	

</script>
</body>
</html>